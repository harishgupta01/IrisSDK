pipeline:
  ssh:
    image: appleboy/drone-ssh
    secrets: [ ssh_host, ssh_username, ssh_password, irisaumurl, irisidmurl, irisevmurl, irisntmurl, irisappkey, irisappsecret, irisenv, irisappdomain, irisinboundservice, irisinboundsecret, irisuserid, irisuserpwd, irisfromtn, iristotn, iriscalleeid ]
    envs: [ irisaumurl, irisidmurl, irisevmurl, irisntmurl, irisappkey, irisappsecret, irisenv, irisappdomain, irisinboundservice, irisinboundsecret, irisuserid, irisuserpwd, irisfromtn, iristotn, iriscalleeid ]
    port: 4222
    script: 
    - cd harish
     - export IRISAUMURL=$${IRISAUMURL}
      - export IRISIDMURL=$${IRISIDMURL} 
      - export IRISEVMURL=$${IRISEVMURL}
      - export IRISNTMURL=$${IRISNTMURL}
      - export IRISAPPKEY=$${IRISAPPKEY} 
      - export IRISAPPSECRET=$${IRISAPPSECRET}
      - export IRISENV=$${IRISENV} 
      - export IRISAPPDOMAIN=$${IRISAPPDOMAIN} 
      - export IRISINBOUNDSERVICE=$${IRISINBOUNDSERVICE} 
      - export IRISINBOUNDSECRET=$${IRISINBOUNDSECRET}
      - export IRISUSERID=$${IRISUSERID}
      - export IRISUSERPWD=$${IRISUSERPWD} 
      - export IRISFROMTN=$${IRISFROMTN} 
      - export IRISTOTN=$${IRISTOTN} 
      - export IRISCALLEEID=$${IRISCALLEEID}   
    - git clone https://github.com/harishgupta01/IrisSDK
    - cd IrisSDK
    - pod install
    - xcodebuild test -workspace IrisRtcSdk/IrisRtcSdk.xcworkspace  -scheme IrisRtcSdk -destination 'platform=iOS Simulator,name=iPhone X,OS=11.4' IRISAUMURL=$IRISAUMURL IRISIDMURL=$IRISIDMURL IRISEVMURL=$IRISEVMURL IRISNTMURL=$IRISNTMURL IRISAPPKEY=$IRISAPPKEY IRISAPPSECRET=$IRISAPPSECRET IRISENV=$IRISENV IRISAPPDOMAIN=$IRISAPPDOMAIN IRISINBOUNDSERVICE=$IRISINBOUNDSERVICE IRISINBOUNDSECRET=$IRISINBOUNDSECRET IRISUSERID=$IRISUSERID IRISUSERPWD=$IRISUSERPWD IRISFROMTN=$IRISFROMTN IRISTOTN=$IRISTOTN IRISCALLEEID=$IRISCALLEEID -only-testing:IrisRtcSdkTests/IrisRtcConnectionTest
